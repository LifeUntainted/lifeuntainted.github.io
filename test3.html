<!DOCTYPE html>
<html>
<head>
  <title>GPT-4 Turbo Chat</title>
  <style>
    /* Basic styling for the chat box */
    #chatbox {
      width: 400px;
      height: 300px;
      border: 1px solid #ccc;
      overflow-y: scroll;
      padding: 10px;
    }
    #user_input {
      width: 300px;
    }
  </style>
</head>
<body>
  <h1>GPT-4 Turbo Chat</h1>
  <div id="chatbox"></div>
  <input type="text" id="user_input" placeholder="Type your message...">
  <button id="send_button">Send</button>

  <script>
    document.getElementById("send_button").addEventListener("click", sendMessage);

    async function sendMessage() {
      const userInput = document.getElementById("user_input").value.trim();
      if (!userInput) return;

      document.getElementById("user_input").value = "";
      displayMessage("user", userInput);

      try {
        // Call the Vercel backend to get a response from OpenAI
        const response = await fetch('https://niche-analyzer-api-321niche-projects.vercel.app/api/nicheAnalyzer', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ userMessage: userInput })
        });

        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const data = await response.json();
        displayMessage("assistant", data.message);
      } catch (error) {
        console.error("Error:", error);
        displayMessage("error", "An error occurred. Please try again.");
      }
    }

    function displayMessage(role, message) {
      const chatbox = document.getElementById("chatbox");
      const div = document.createElement("div");
      div.innerHTML = `<strong>${role}:</strong> ${message}`;
      chatbox.appendChild(div);
      chatbox.scrollTop = chatbox.scrollHeight;
    }
  </script>
</body>
</html>
